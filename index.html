<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»©ç‚¹è®¡ç®—å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                        accent: '#F59E0B',
                        neutral: '#6B7280',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .animate-float {
                animation: float 3s ease-in-out infinite;
            }
            @keyframes float {
                0% { transform: translateY(0px); }
                50% { transform: translateY(-10px); }
                100% { transform: translateY(0px); }
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-purple-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-3xl">
        <header class="text-center mb-10">
            <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4 animate-float">
                <i class="fa fa-calculator text-2xl text-primary"></i>
            </div>
            <h1 class="text-[clamp(1.8rem,5vw,2.5rem)] font-bold text-gray-800 mb-2">ç»©ç‚¹è®¡ç®—å™¨</h1>
            <p class="text-neutral text-lg">è½»æ¾è®¡ç®—ä½ çš„å¹³å‡ç»©ç‚¹</p>
        </header>

        <main class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-8">
            <div id="welcome-screen">
                <div class="mb-6">
                    <label for="user-name" class="block text-gray-700 font-medium mb-2">è¯·è¾“å…¥æ‚¨çš„å§“åï¼š</label>
                    <input type="text" id="user-name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all" placeholder="ä¾‹å¦‚ï¼šå¼ ä¸‰">
                </div>
                <button id="start-btn" class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-3 px-6 rounded-lg transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-md hover:shadow-lg">
                    å¼€å§‹è®¡ç®— <i class="fa fa-arrow-right ml-2"></i>
                </button>
            </div>

            <div id="calculator-screen" class="hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold text-gray-800">
                        <span id="user-display-name">åŒå­¦</span>ï¼Œ<br>è¯·è¾“å…¥è¯¾ç¨‹ä¿¡æ¯
                    </h2>
                    <span id="course-count" class="bg-secondary/10 text-secondary px-3 py-1 rounded-full text-sm font-medium">
                        å·²è¾“å…¥ 0 é—¨è¯¾ç¨‹
                    </span>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label for="course-name" class="block text-gray-700 font-medium mb-2 text-sm">è¯¾ç¨‹åç§°</label>
                        <input type="text" id="course-name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all" placeholder="ä¾‹å¦‚ï¼šé«˜ç­‰æ•°å­¦">
                    </div>
                    <div>
                        <label for="course-credit" class="block text-gray-700 font-medium mb-2 text-sm">è¯¾ç¨‹å­¦åˆ†</label>
                        <input type="number" id="course-credit" min="0.5" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all" placeholder="ä¾‹å¦‚ï¼š4">
                    </div>
                    <div>
                        <label for="course-grade" class="block text-gray-700 font-medium mb-2 text-sm">è¯¾ç¨‹ç»©ç‚¹</label>
                        <input type="number" id="course-grade" min="0" max="5" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all" placeholder="ä¾‹å¦‚ï¼š4.5">
                    </div>
                </div>

                <div class="flex gap-4 mb-8">
                    <button id="add-course-btn" class="flex-1 bg-secondary hover:bg-secondary/90 text-white font-medium py-2.5 px-4 rounded-lg transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-md hover:shadow-lg">
                        <i class="fa fa-plus mr-2"></i> æ·»åŠ è¯¾ç¨‹
                    </button>
                    <button id="calculate-btn" class="flex-1 bg-primary hover:bg-primary/90 text-white font-medium py-2.5 px-4 rounded-lg transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-md hover:shadow-lg">
                        <i class="fa fa-calculator mr-2"></i> è®¡ç®—ç»©ç‚¹
                    </button>
                </div>

                <div class="border-t pt-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">å·²è¾“å…¥è¯¾ç¨‹</h3>
                    <div id="course-list" class="space-y-3 max-h-60 overflow-y-auto pr-2">
                        <div class="text-center text-neutral italic py-4">
                            æš‚æ— è¯¾ç¨‹ä¿¡æ¯
                        </div>
                    </div>
                </div>
            </div>

            <div id="result-screen" class="hidden">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">è®¡ç®—ç»“æœ</h2>
                    <p class="text-neutral">ä»¥ä¸‹æ˜¯æ‚¨çš„ç»©ç‚¹ç»Ÿè®¡ä¿¡æ¯</p>
                </div>

                <div class="bg-gray-50 rounded-lg p-6 mb-6">
                    <div class="flex flex-col items-center">
                        <div class="w-32 h-32 rounded-full bg-primary/10 flex items-center justify-center mb-4">
                            <div class="text-center">
                                <span id="gpa-value" class="block text-4xl font-bold text-primary">0.00</span>
                                <span class="text-sm text-neutral">å¹³å‡ç»©ç‚¹</span>
                            </div>
                        </div>
                        <p id="gpa-comment" class="text-lg font-medium text-gray-800 mb-2"></p>
                        <p class="text-neutral text-sm">åŸºäº <span id="total-courses" class="font-medium">0</span> é—¨è¯¾ç¨‹ï¼Œæ€»å­¦åˆ†ä¸º <span id="total-credits" class="font-medium">0</span></p>
                    </div>
                </div>

                <div class="border-t pt-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">è¯¾ç¨‹æ˜ç»†</h3>
                    <div id="result-course-list" class="space-y-3 max-h-60 overflow-y-auto pr-2">
                        <!-- ç»“æœä¸­çš„è¯¾ç¨‹åˆ—è¡¨ -->
                    </div>
                </div>

                <div class="mt-8 flex gap-4">
                    <button id="recalculate-btn" class="flex-1 bg-primary hover:bg-primary/90 text-white font-medium py-2.5 px-4 rounded-lg transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-md hover:shadow-lg">
                        <i class="fa fa-refresh mr-2"></i> é‡æ–°è®¡ç®—
                    </button>
                    <button id="share-btn" class="flex-1 bg-accent hover:bg-accent/90 text-white font-medium py-2.5 px-4 rounded-lg transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-md hover:shadow-lg">
                        <i class="fa fa-share-alt mr-2"></i> åˆ†äº«ç»“æœ
                    </button>
                </div>
            </div>
        </main>

        <footer class="text-center text-neutral text-sm">
            <p>ç»©ç‚¹è®¡ç®—å™¨ &copy; 2025 | ä¸€ä½æ‹¥æœ‰Jiebaå†œåœºçš„ç å†œ</p>
        </footer>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let userName = '';
        let courses = [];

        // DOMå…ƒç´ 
        const welcomeScreen = document.getElementById('welcome-screen');
        const calculatorScreen = document.getElementById('calculator-screen');
        const resultScreen = document.getElementById('result-screen');
        const userNameInput = document.getElementById('user-name');
        const userDisplayName = document.getElementById('user-display-name');
        const courseNameInput = document.getElementById('course-name');
        const courseCreditInput = document.getElementById('course-credit');
        const courseGradeInput = document.getElementById('course-grade');
        const courseList = document.getElementById('course-list');
        const resultCourseList = document.getElementById('result-course-list');
        const courseCount = document.getElementById('course-count');
        const gpaValue = document.getElementById('gpa-value');
        const gpaComment = document.getElementById('gpa-comment');
        const totalCourses = document.getElementById('total-courses');
        const totalCredits = document.getElementById('total-credits');

        // æŒ‰é’®äº‹ä»¶
        document.getElementById('start-btn').addEventListener('click', startCalculator);
        document.getElementById('add-course-btn').addEventListener('click', addCourse);
        document.getElementById('calculate-btn').addEventListener('click', calculateGPA);
        document.getElementById('recalculate-btn').addEventListener('click', resetCalculator);
        document.getElementById('share-btn').addEventListener('click', shareResult);

        // å¼€å§‹è®¡ç®—å™¨
        function startCalculator() {
            userName = userNameInput.value.trim() || 'åŒå­¦';
            userDisplayName.textContent = userName;
            welcomeScreen.classList.add('hidden');
            calculatorScreen.classList.remove('hidden');
            updateCourseCount();
        }

        // æ·»åŠ è¯¾ç¨‹
        function addCourse() {
            const name = courseNameInput.value.trim();
            const credit = parseFloat(courseCreditInput.value);
            const grade = parseFloat(courseGradeInput.value);

            // éªŒè¯è¾“å…¥
            if (!name) {
                showToast('è¯·è¾“å…¥è¯¾ç¨‹åç§°', 'error');
                return;
            }

            if (isNaN(credit) || credit <= 0) {
                showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„å­¦åˆ†ï¼ˆå¤§äº0ï¼‰', 'error');
                return;
            }

            if (isNaN(grade) || grade < 0 || grade > 5) {
                showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„ç»©ç‚¹ï¼ˆ0-5ä¹‹é—´ï¼‰', 'error');
                return;
            }

            // æ·»åŠ è¯¾ç¨‹åˆ°åˆ—è¡¨
            courses.push({ name, credit, grade });

            // æ›´æ–°æ˜¾ç¤º
            updateCourseList();
            updateCourseCount();

            // æ¸…ç©ºè¾“å…¥
            courseNameInput.value = '';
            courseCreditInput.value = '';
            courseGradeInput.value = '';
            courseNameInput.focus();

            showToast('è¯¾ç¨‹å·²æ·»åŠ ', 'success');
        }

        // æ›´æ–°è¯¾ç¨‹åˆ—è¡¨æ˜¾ç¤º
        function updateCourseList() {
            if (courses.length === 0) {
                courseList.innerHTML = `
                    <div class="text-center text-neutral italic py-4">
                        æš‚æ— è¯¾ç¨‹ä¿¡æ¯
                    </div>
                `;
                return;
            }

            courseList.innerHTML = '';
            courses.forEach((course, index) => {
                const courseItem = document.createElement('div');
                courseItem.className = 'bg-gray-50 rounded-lg p-3 flex items-center justify-between';
                courseItem.innerHTML = `
                    <div class="flex-1 mr-3">
                        <div class="font-medium text-gray-800">${course.name}</div>
                        <div class="text-sm text-neutral">å­¦åˆ†: ${course.credit} | ç»©ç‚¹: ${course.grade}</div>
                    </div>
                    <button class="text-red-500 hover:text-red-700 transition-colors" onclick="removeCourse(${index})">
                        <i class="fa fa-trash"></i>
                    </button>
                `;
                courseList.appendChild(courseItem);
            });
        }

        // ç§»é™¤è¯¾ç¨‹
        function removeCourse(index) {
            courses.splice(index, 1);
            updateCourseList();
            updateCourseCount();
            showToast('è¯¾ç¨‹å·²ç§»é™¤', 'info');
        }

        // æ›´æ–°è¯¾ç¨‹è®¡æ•°
        function updateCourseCount() {
            courseCount.textContent = `å·²è¾“å…¥ ${courses.length} é—¨è¯¾ç¨‹`;
        }

        // è®¡ç®—GPA
        function calculateGPA() {
            if (courses.length === 0) {
                showToast('è¯·è‡³å°‘æ·»åŠ ä¸€é—¨è¯¾ç¨‹', 'error');
                return;
            }

            // è®¡ç®—æ€»å­¦åˆ†å’ŒåŠ æƒç»©ç‚¹
            let totalCredit = 0;
            let weightedGrade = 0;

            courses.forEach(course => {
                totalCredit += course.credit;
                weightedGrade += course.credit * course.grade;
            });

            // è®¡ç®—å¹³å‡ç»©ç‚¹
            const gpa = weightedGrade / totalCredit;

            // æ›´æ–°ç»“æœæ˜¾ç¤º
            gpaValue.textContent = gpa.toFixed(2);
            totalCourses.textContent = courses.length;
            totalCredits.textContent = totalCredit.toFixed(1);

            // æ ¹æ®ç»©ç‚¹ç»™å‡ºè¯„ä»·
            if (gpa >= 4.5) {
                gpaComment.textContent = 'ğŸ‰ æˆç»©ä¼˜å¼‚ï¼Œç»§ç»­ä¿æŒï¼';
                gpaComment.className = 'text-lg font-medium text-green-600 mb-2';
            } else if (gpa >= 3.5) {
                gpaComment.textContent = 'ğŸ‘ è¡¨ç°è‰¯å¥½ï¼Œå†æ¥å†å‰ï¼';
                gpaComment.className = 'text-lg font-medium text-blue-600 mb-2';
            } else if (gpa >= 2.0) {
                gpaComment.textContent = 'ğŸ’ª ä»éœ€åŠªåŠ›ï¼ŒåŠ æ²¹ï¼';
                gpaComment.className = 'text-lg font-medium text-orange-600 mb-2';
            } else {
                gpaComment.textContent = 'ğŸ™ æˆç»©åä½ï¼Œå»ºè®®åŠ å¼ºå­¦ä¹ ';
                gpaComment.className = 'text-lg font-medium text-red-600 mb-2';
            }

            // æ˜¾ç¤ºç»“æœè¯¾ç¨‹åˆ—è¡¨
            resultCourseList.innerHTML = '';
            courses.forEach(course => {
                const courseItem = document.createElement('div');
                courseItem.className = 'bg-gray-50 rounded-lg p-3 flex items-center justify-between';
                courseItem.innerHTML = `
                    <div class="flex-1 mr-3">
                        <div class="font-medium text-gray-800">${course.name}</div>
                        <div class="text-sm text-neutral">å­¦åˆ†: ${course.credit} | ç»©ç‚¹: ${course.grade}</div>
                    </div>
                    <div class="text-right">
                        <div class="font-medium text-gray-800">${(course.credit * course.grade).toFixed(2)}</div>
                        <div class="text-xs text-neutral">åŠ æƒåˆ†æ•°</div>
                    </div>
                `;
                resultCourseList.appendChild(courseItem);
            });

            // åˆ‡æ¢åˆ°ç»“æœé¡µé¢
            calculatorScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
        }

        // é‡ç½®è®¡ç®—å™¨
        function resetCalculator() {
            courses = [];
            updateCourseList();
            updateCourseCount();
            resultScreen.classList.add('hidden');
            calculatorScreen.classList.remove('hidden');
            showToast('è®¡ç®—å™¨å·²é‡ç½®', 'info');
        }

        // åˆ†äº«ç»“æœ
        function shareResult() {
            // åˆ›å»ºåˆ†äº«å†…å®¹
            let shareText = `ğŸ“Š ${userName}çš„ç»©ç‚¹è®¡ç®—ç»“æœ\n\n`;
            shareText += `å¹³å‡ç»©ç‚¹ï¼š${gpaValue.textContent}\n`;
            shareText += `è¯¾ç¨‹æ•°é‡ï¼š${totalCourses.textContent}é—¨\n`;
            shareText += `æ€»å­¦åˆ†ï¼š${totalCredits.textContent}\n\n`;
            shareText += `è¯¾ç¨‹æ˜ç»†ï¼š\n`;

            courses.forEach(course => {
                shareText += `- ${course.name}ï¼šå­¦åˆ†${course.credit}ï¼Œç»©ç‚¹${course.grade}\n`;
            });

            shareText += `\n${gpaComment.textContent.replace(/(<([^>]+)>)/gi, "")}`;

            // å¤åˆ¶åˆ°å‰ªè´´æ¿
            navigator.clipboard.writeText(shareText).then(() => {
                showToast('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            }).catch(err => {
                showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
                console.error('æ— æ³•å¤åˆ¶å†…å®¹: ', err);
            });
        }

        // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        function showToast(message, type = 'info') {
            // åˆ›å»ºtoastå…ƒç´ 
            const toast = document.createElement('div');
            toast.className = `fixed bottom-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300 opacity-0`;

            // è®¾ç½®ä¸åŒç±»å‹çš„æ ·å¼
            if (type === 'success') {
                toast.classList.add('bg-green-500', 'text-white');
                toast.innerHTML = `<i class="fa fa-check-circle mr-2"></i> ${message}`;
            } else if (type === 'error') {
                toast.classList.add('bg-red-500', 'text-white');
                toast.innerHTML = `<i class="fa fa-exclamation-circle mr-2"></i> ${message}`;
            } else {
                toast.classList.add('bg-blue-500', 'text-white');
                toast.innerHTML = `<i class="fa fa-info-circle mr-2"></i> ${message}`;
            }

            // æ·»åŠ åˆ°é¡µé¢
            document.body.appendChild(toast);

            // æ˜¾ç¤ºåŠ¨ç”»
            setTimeout(() => {
                toast.classList.remove('opacity-0');
                toast.classList.add('opacity-100');
            }, 10);

            // 3ç§’åéšè—
            setTimeout(() => {
                toast.classList.remove('opacity-100');
                toast.classList.add('opacity-0');

                // å®Œå…¨éšè—åç§»é™¤å…ƒç´ 
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // å…è®¸åœ¨HTMLä¸­è°ƒç”¨removeCourseå‡½æ•°
        window.removeCourse = removeCourse;
    </script>
</body>
</html>
